function DoFieldonClick(b){var e=b.getAttribute("xvalue");var a=document.getElementById("NewCurrentView");if(b.className=="denote"){for(c=a.length-1;c>=0;c--){if(a.options[c].value==e){a.remove(c);inittree("tree_route",1)}}b.className="note"}else{var d=document.createElement("option");for(c=0;c<a.length;c++){a.options[c].selected=false}a.appendChild(d);d.text=b.childNodes[1].nodeValue;d.value=e;inittree("tree_route",1);b.firstChild.className="lispan"}}function inittree(tree,m){var view=document.getElementById("NewCurrentView");var ss=document.getElementById("shortsearch");for(var c=0;c<document.getElementById(tree).childNodes.length;c++){var srcview=document.getElementById(tree).childNodes[c];if(srcview.nodeName=="LI"||srcview.nodeName=="UL"){if(srcview.getAttribute("xhead")==1){xc=0}if(srcview.getAttribute("downpoint")==1){srcview.className="note";for(var i=0;i<view.length;i++){if(view.options[i].value==srcview.getAttribute("xvalue")){srcview.className="denote"}if(ss.value!=""){srcview.style.display="none"}else{srcview.style.display="block"}var pattern=eval("/"+ss.value+"/gi");var xsv;if(typeof srcview.textContent=="undefined"){xsv=srcview.innerText}else{xsv=srcview.textContent}if(xsv.match(pattern)&&ss.value!=""){srcview.style.display="block";srcview.parentNode.parentNode.className="liOpen";srcview.parentNode.parentNode.style.display="block";xc=1}else{if(xc==0&&m!=1){if(ss.value==""){srcview.parentNode.parentNode.className="liClosed";srcview.parentNode.parentNode.style.display="block"}else{srcview.parentNode.parentNode.style.display="none"}}}}}inittree(srcview.id,m)}}}function ShSearch(){var a=window.document.getElementById("FullFieldTreeSelect");inittree("tree_route")}function RefreshViewDropDown(a){var b=window.document.getElementById("FullFieldTreeSelect");var d=window.document.getElementById("NewCurrentView");if(b&&d){b.style.height=d.offsetHeight;d.style.height=b.offsetHeight}inittree(a,1);return}var DataChanged=0;function addEvent(d,b,a){if(d.addEventListener){d.addEventListener(b,a,true);return true}else{if(d.attachEvent){return d.attachEvent("on"+b,a)}else{return false}}}function setDefault(a,b){if(typeof(window[a])=="undefined"||window[a]==null){window[a]=b}}function expandTree(b){var a=document.getElementById(b);if(a==null){return false}expandCollapseList(a,nodeOpenClass)}function collapseTree(b){var a=document.getElementById(b);if(a==null){return false}expandCollapseList(a,nodeClosedClass)}function expandToItem(d,f){var b=document.getElementById(d);if(b==null){return false}var a=expandCollapseList(b,nodeOpenClass,f);if(a){var e=document.getElementById(f);if(e.scrollIntoView){e.scrollIntoView(false)}}}function expandCollapseList(e,h,g){if(!e.childNodes||e.childNodes.length==0){return false}for(var a=0;a<e.childNodes.length;a++){var i=e.childNodes[a];if(g!=null&&i.id==g){return true}if(i.nodeName=="LI"){var f=false;for(var b=0;b<i.childNodes.length;b++){var j=i.childNodes[b];if(j.nodeName=="UL"){f=true;var d=expandCollapseList(j,h,g);if(g!=null&&d){i.className=h;return true}}}if(f&&g==null){i.className=h}}}}function convertTrees(){setDefault("treeClass","mktree");setDefault("nodeClosedClass","liClosed");setDefault("nodeOpenClass","liOpen");setDefault("nodeBulletClass","liBullet");setDefault("nodeLinkClass","bullet");setDefault("preProcessTrees",true);if(preProcessTrees){if(!document.createElement){return}uls=document.getElementsByTagName("ul");for(var b=0;b<uls.length;b++){var a=uls[b];if(a.nodeName=="UL"&&a.className==treeClass){processList(a)}}}}function processList(d,f){if(!d.childNodes||d.childNodes.length==0){return}for(var a=0;a<d.childNodes.length;a++){var h=d.childNodes[a];if(h.nodeName=="LI"){var e=false;for(var b=0;b<h.childNodes.length;b++){var i=h.childNodes[b];if(i.nodeName=="UL"){e=true;processList(i)}}var j=document.createElement("SPAN");var g="\u00A0";j.className=nodeLinkClass;if(e){if(h.className==null||h.className==""){h.className=nodeClosedClass}if(h.firstChild.nodeName=="#text"){g=g+h.firstChild.nodeValue;h.removeChild(h.firstChild)}j.onclick=function(){this.parentNode.className=(this.parentNode.className==nodeOpenClass)?nodeClosedClass:nodeOpenClass;return false}}else{if(h.className!="denote"){h.className=nodeBulletClass;j.onclick=function(){return false}}}j.appendChild(document.createTextNode(g));h.insertBefore(j,h.firstChild);if(h.className=="denote"){h.firstChild.className="lispan";j.onclick=function(){return false}}else{if(h.className=="liBullet"){h.firstChild.className="lispan"}}}}};